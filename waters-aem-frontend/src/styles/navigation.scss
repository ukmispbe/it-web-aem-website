@mixin level2GridAreas($from, $through) {
   $itemsPerRow: 8;
   $column: 0;
   $row: 0;

   @for $i from $from through $through {
      $row: $row + 1;
      $column: ceil($i / $itemsPerRow);

      @if $row > $itemsPerRow {
         $row: 1;
      }

      & > .cmp-navigation__item:nth-child(#{$i}) {
         grid-area: column#{$column}_row#{$row};

         @if $i > $itemsPerRow {
            padding-left: $space-m;
         }
      }
   }
}

.navigation {
   position: relative;
   float: none!important;
   background-color: $color-white;
   z-index: 998;
   height: 67px;
   width: 105%!important;
   padding: 0 $space-xl;
   margin: 0 (($space-xl - (14/(16*1.1)))*-1)!important; 
}

nav.cmp-navigation {
   white-space: nowrap;
   overflow-x: scroll;
   height: inherit;

   &::after {
       width: 100%;
       height: 67px;
       content: '';
       position: absolute;
       box-shadow: $shadow; 
       left: 0;
       top: 0;
       z-index: 1000;
       visibility: hidden;
       background: none;
       pointer-events: none;
   }

   &:hover {
      &::after {
         visibility: visible;
      }
   }

   & > .cmp-navigation__group {
      padding: 0;
      margin-bottom: 0;

      & > .cmp-navigation__item {
         @include font-h3;
         margin-right: $space-xl;
         margin-bottom: 0;
         display: inline-block;

         &--level-0 {
            height: 67px;
            z-index: 1001;
            align-content: center;
            display: inline-grid;
            border-top: 3px solid transparent;

            &:hover {
               cursor: pointer;
               border-top: 3px solid  $color-gray-50;
            }

            &::after {
               content: '';
               margin-top: -48px;
               width: $space-xl + 0.3em;
               position: relative;
               top: -70%;
               left: 100%;
               float: right;
               margin-bottom: -19px;
            }
         }

         & > .cmp-navigation__item-link {
            color: $color-font-medium;
            -webkit-transition: none;
            -o-transition: none;
            -moz-transition: none;
            transition: none;

            &:hover {
               color: $color-font-dark;
               text-decoration: none;
            }
         }

         & > .cmp-navigation__group {
            position: absolute;
            top: 67px;
            left: 0;
            z-index: 99;
            visibility: hidden;
            list-style: none;
            padding: $space-l $space-xl  $space-xl $space-xl;
            background-color: $color-white;
            width: 100%;

            & > .cmp-navigation__item {
               @include font-h3;
               margin-bottom: 0;
               padding-bottom: $space-s;
            }
         }

         & > .cmp-navigation__group.cmp-navigation__group--col-1 {
            display: flex;
            flex-direction: column;

            & > .cmp-navigation__item {
               width: 335px;
            }
         }

         & > .cmp-navigation__group.cmp-navigation__group--col-2 {
            display: grid;
            grid-template-rows: auto;
            grid-template-columns: 335px 335px;

            grid-template-areas:
               "column1_row1 column2_row1"
               "column1_row2 column2_row2"
               "column1_row3 column2_row3"
               "column1_row4 column2_row4"
               "column1_row5 column2_row5"
               "column1_row6 column2_row6"
               "column1_row7 column2_row7"
               "column1_row8 column2_row8";

            // include up to 16 areas for 2 columns of 8
            @include level2GridAreas(1, 16);
         }

         & > .cmp-navigation__group.cmp-navigation__group--col-3 {
            display: grid;
            grid-template-rows: auto;
            grid-template-columns: 335px 335px 1fr;

            grid-template-areas:
               "column1_row1 column2_row1 column3_row1"
               "column1_row2 column2_row2 column3_row2"
               "column1_row3 column2_row3 column3_row3"
               "column1_row4 column2_row4 column3_row4"
               "column1_row5 column2_row5 column3_row5"
               "column1_row6 column2_row6 column3_row6"
               "column1_row7 column2_row7 column3_row7"
               "column1_row8 column2_row8 column3_row8";

             // include up to 24 areas for 3 columns of 8
             @include level2GridAreas(1, 24);
         }

         &:hover > .cmp-navigation__group {
            visibility: visible;

            & .cmp-navigation__item-link {
               -webkit-transition: none;
               -o-transition: none;
               -moz-transition: none;
               transition: none;
            }
         }
      }
   }
}

.cmp-navigation__item-link {
   -webkit-transition: none;
   -o-transition: none;
   -moz-transition: none;
   transition: none;
}

.cmp-navigation-overlay__container {
   &.overlay-container {
      z-index: 97;
      visibility: hidden;
   }
}
